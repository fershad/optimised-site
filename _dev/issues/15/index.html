<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="preconnect" href="https://rudolph-rebel-rebel.fershad.com">
  <script async src="/js/instant-page.mjs" type="module"></script>
  <script async nomodule="" src="/js/instant-page.js"></script>
  <link rel="icon" href="/favicon.ico" type="image/x-icon" sizes="any">
  <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
  <link rel="manifest" href="/manifest.json">
<link href="/assets/css/main.css" rel="stylesheet" media="print" onload="this.media='all'"></head>

<body>
  <a class="skip-link" href="#main-content">Skip to content</a>

  

  <header>
    <div class="wrapper">
        <div class="logo">
            Optimised
            </a>
            <div>
                <small>A newsletter about website performance and sustainability.</small>
            </div>
        </div>
        <nav>
            <ul>
                
                
                <li>
                    <a href="http://localhost:8080">Archive</a>
                </li>
                
                
                
                <li>
                    <a href="http://localhost:8080/series/">Series</a>
                </li>
                
                
                
                
            </ul>
        </nav>
    </div>
</header>
  <main id="main-content" class="wrapper flow"><h1>Optimising web fonts - Part 3: Loading strategies</h1>
<p>Mid-last week Google announced that it is giving folks a bit more time to <a href="https://developers.google.com/search/blog/2021/04/more-details-page-experience">get ready for the Core Web Vitals (page experience) update</a>. I think they really meant to say, &quot;we're still working on finalising Core Web Vitals (especially CLS), so we need to delay things&quot;. Anyway, the new timeframe is from mid-June to August. The changes will be rolled out gradually and will take full effect at the end of August.</p>
<p>With that out of the way, let's get onto the final part of our web font optimisation series. This week we'll look at loading strategies that can get custom fonts appearing on your site faster. This is an important part of reducing/eliminating layout shifts during page load.</p>
<hr>
<p>I'm going to sound like a broken record here, but the most optimal font loading strategy is to use system fonts on your site. There's no network or download latency involved, so fonts will appear almost instantly.</p>
<p>Now that the mandatory <em>'use system fonts'</em> comment is done, let's return to the real world where brands require custom, creative typefaces to be used on their websites. How do we make web fonts load faster so that they're not negatively impacting the overall page experience? It can get really complicated, but here are some of the easier wins.</p>
<ul>
<li>Reduce the file size (covered in <a href="https://optimised.email/issues/issue-14-optimising-web-fonts-part-2">Part 2</a> of this series)</li>
<li>Host files on your own domain.</li>
<li>Use <code>preload</code> to download font files earlier.</li>
<li>Use <code>font-display</code> effectively.</li>
</ul>
<h2>Self-host font files</h2>
<p>The easiest way to use a web font is to find it on Google Fonts (or another font repository). You'll be given a code snippet to paste into your site's code. That's all well and good, but there are a couple of downsides that come with using fonts hosted on external domains:</p>
<ul>
<li>There are multiple network requests (including TCP/SSL handshakes) that need to be made to get stylesheets and font files.</li>
<li>Chrome &amp; Safari prevent cross-site resource caching, so there are no performance gains from using a common online third-party source for assets.</li>
</ul>
<p>Hosting resources like fonts on your own domain can help speed up the request time for assets since there's no need to initiate new TCP/SSL connections each time.</p>
<h2>Use <code>preload</code> effectively</h2>
<p>Effectively is the keyword in the title of this section. Preload is extremely handy in prompting the browser to download certain assets earlier than it otherwise might. However, <em>if everything is a priority, then nothing is</em>.</p>
<p>Fonts are late discovered resources. They're found by the browser only once CSS is downloaded and is being parsed. If you're loading CSS using JavaScript, the browser has to download the JS, compile and parse it, before parsing the CSS. That can take a while, especially on low-end devices. Preload helps us here, in that we can download a few font files in advance and have them ready for the browser as soon as it needs them.</p>
<p>We covered <code>preload</code> in general back in <a href="https://optimised.email/issues/issue-10-resource-hints-part-2">Issue 10</a>, but how could we apply it specifically to web fonts? Here are a few general things to keep in mind:</p>
<ul>
<li>Try to preload only one web font (if you're not preloading much else you could push it to two - try it, measure the results, and act accordingly).</li>
<li>If you're using WOFF2 then preload that file.</li>
<li>When it comes to deciding what font to pick, there are a few ways to go about this:
<ul>
<li>Pick the first font that appears in your CSS <code>@font-face</code> stack. This is a good rule of thumb.</li>
<li>If you have a large title visible when the page loads, consider preloading this instead. The title element would most likely be a Largest Contentful Paint (LCP) candidate, so having the font file ready for it can help with your LCP Core Web Vitals score.</li>
<li>If fonts are causing layout shifts as your page loads, then try to identify the culprit &amp; preload that font to minimise its impact on your Cumulative Layout Shift (CLS) Core Web Vitals score.</li>
</ul>
</li>
<li>The <code>crossorigin</code> attribute is required when preloading web fonts, even if they're hosted on your own domain. Just add <code>crossorigin</code> to the end of the preload link tag.</li>
</ul>
<p>The preload tag you'd place in the head of your HTML page should end up looking something like this:</p>
<pre><code class="language-html">&lt;link rel=&quot;preload&quot; href=&quot;webfont.woff2&quot; as=&quot;font&quot; type=&quot;font/woff2&quot; crossorigin&gt;
</code></pre>
<h2>Use <code>font-display</code> effectively</h2>
<p>The word effectively is a bit less important here. <code>font-display</code> is a CSS property you can add to the <code>@font-face</code> blocks of your code to tell the browser how to handle that displaying content <em>before</em> a web font is fully downloaded.</p>
<p>There are four options for <code>font-display</code> but we're only going to concentrate on two of them.</p>
<h3><code>font-display: swap</code></h3>
<p>With <code>swap</code> you're telling the browser to show text immediately using the first available fallback font, and then swap in the web font when it's downloaded.</p>
<h4><strong>Benefit</strong></h4>
<ul>
<li>You'll show textual content early, even if the font hasn't loaded. Better for LCP.</li>
</ul>
<h4><strong>Be careful</strong></h4>
<ul>
<li>Swapping in the web font after it has been downloaded is a very common cause for layout shift (poor CLS scores). If you're going to use this approach, then take the time to match your fallback fonts as closely as possible to your web font - this reduces the visual disturbance caused when the fallback font gets replaced. <a href="https://meowni.ca/font-style-matcher/">Font Style Matcher</a> is a very good tool for this.</li>
</ul>
<h3><code>font-display: optional</code></h3>
<p>Using <code>optional</code> you instruct the browser to hide text for 100ms and then load the web font only if it's available. If it's not ready, then the browser will use a fallback font instead for that page view.</p>
<h4><strong>Benefit</strong></h4>
<ul>
<li>No layout shift (better for CLS), and only a very small hit to LCP scores.</li>
<li>Even if the web font is not ready within the 100ms window initially, the browser will still download &amp; cache it (assuming cache headers are properly set). This means that the next page a user visits (or the next time they come back to your site), the web font will be ready to use right away.</li>
</ul>
<h4><strong>Be careful</strong></h4>
<ul>
<li>If you're especially picky about the typography of your site, then choose fallback fonts carefully when using this approach. There's a strong chance any visitor to your site will have at least one page experience rendered with a fallback font.</li>
</ul>
<p>The above factors should get you well on the way to better font loading performance on your website. If you want to dive deeper into the weeds of font optimisation, you can read Zach Leatherman's <a href="https://www.zachleat.com/web/comprehensive-webfonts/#fout-class">A Comprehensive Guide to Font Loading Strategies</a>.</p>
<h3>Resources</h3>
<ul>
<li><strong><a href="https://optimised.email/issues/issue-9-resource-hints-part-1">Part 1</a></strong> &amp; <strong><a href="https://optimised.email/issues/issue-10-resource-hints-part-2">2</a></strong> of this series for some reference.</li>
<li><strong><a href="https://www.zachleat.com/web/comprehensive-webfonts/#fout-class">A Comprehensive Guide to Font Loading Strategies</a></strong> - As the name suggests, a deep dive into the many and varied font loading approaches available to web developers. Recommended reading that adds to what we've covered in this series.</li>
</ul>
<h3>Articles</h3>
<p><strong><a href="https://calibreapp.com/blog/convince-your-boss-about-performance">How to Convince Your Boss to Care About Speed</a></strong><br>
You might care about web performance, but getting it on your boss' list of priorities can be a challenge. The team over at Calibre have some tips to help you persuade the leaders in your company to put more attention on website Performance.</p>
<p><strong><a href="https://adactio.com/journal/18046">Get the FLoC Out</a></strong><br>
Jeremy Keith's take on FLoC. This is a well thought out article that looks at Google's latest move to counter the demise of third-party cookies for data collection. <a href="https://www.fershad.com/blog/posts/this-website-is-a-floc-free-zone/#main-content">I've opted-out out of FLoC</a> for both my personal website and the Optimised site.</p>
<hr>
<p>The next issue of Optimised will be in your inbox on May 14th. The website has an <strong><a href="https://optimised.email/">archive of all previous emails</a></strong>. It's a good place to recap on anything we've covered, and also handy to share with friends or colleagues.</p>
<p>As always if you've got any feedback or specific topics you want to be covered then just reply to this email.</p>
<p>Keep safe, stay well.<br>
Fershad.</p>
</main>
  <footer class="footer">
    <div class="wrapper text-center flow">
        <div id="wcb-wrapper"></div>
        <nav>
            <ul>
                
                    <li>
                        <a href="http://localhost:8080">Archive</a>
                    </li>
                
                    <li>
                        <a href="http://localhost:8080/series/">Series</a>
                    </li>
                
                    <li>
                        <a href="http://localhost:8080/contact/">Contact</a>
                    </li>
                
            </ul>
        </nav>
        <div class="text-center">
            <p>Copyright 2022 Fershad Digital
            </p>
            <small>Fershad Digital LTD is a company registered in Taiwan.
                <br>Unified business number: 82954243
                <br>
                <a href="http://localhost:8080/privacy">Privacy policy</a>
            </small>
        </div>
    </div>
</footer>

<!-- <script async src="/js/carbon-badge.mjs" type="module"></script>
<script async nomodule="" src="/js/carbon-badge.js"></script> -->


  <svg class="svg-filters" style="display:none;" version="1.1" xmlns="http://www.w3.org/2000/svg">
    <defs>
      <filter id="marker-shape">
        <feTurbulence basefrequency="0 0.15" numoctaves="1" result="warp" type="fractalNoise" />
        <feDisplacementMap in2="warp" ein="SourceGraphic" scale="30" xchannelselector="R" ychannelselector="G" />
      </filter>
    </defs>
    <rect width="100%" height="100%" filter="url(#marker-shape)" />
  </svg>

  <script async src="/prism/prism.js"></script>
  <link href="/assets/css/tokens.css" rel="stylesheet">

  
</body>

</html>