<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="preconnect" href="https://rudolph-rebel-rebel.fershad.com">
  <script async src="/js/instant-page.mjs" type="module"></script>
  <script async nomodule="" src="/js/instant-page.js"></script>
  <link rel="icon" href="/favicon.ico" type="image/x-icon" sizes="any">
  <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
  <link rel="manifest" href="/manifest.json">
<link href="/assets/css/main.css" rel="stylesheet" media="print" onload="this.media='all'"></head>

<body>
  <a class="skip-link" href="#main-content">Skip to content</a>

  

  <header>
    <div class="wrapper">
        <div class="logo">
            Optimised
            </a>
            <div>
                <small>A newsletter about website performance and sustainability.</small>
            </div>
        </div>
        <nav>
            <ul>
                
                
                <li>
                    <a href="http://localhost:8080">Archive</a>
                </li>
                
                
                
                <li>
                    <a href="http://localhost:8080/series/">Series</a>
                </li>
                
                
                
                
            </ul>
        </nav>
    </div>
</header>
  <main id="main-content" class="wrapper flow"><h1>Optimising embedded content</h1>
<p>Hello again. It's been another eventful couple of weeks since the last email. Personally, I've been working on a side project that's aiming to track clean energy generation in Taiwan. It's been interesting looking into the different energy tech that's around. I've also been spending time looking at various ways to reduce the carbon footprint of the website.</p>
<p>A website's carbon footprint isn't something people think about, but it goes hand in hand with performance. An optimised website is, more often than not, one that's also less energy-intensive. I could talk all day about this, and there'll be at least one issue of this newsletter touching on the topic. If you'd like to know more about the relationship between websites and carbon emissions just reach out to me. Now, onto this week's topic.</p>
<hr>
<p>This week I want to cover a few ways you can optimise pages that have Twitter/YouTube content embeds. The idea for this newsletter stems from a tweet by Matt Hobbs in which he points out just how much bloat an embedded tweet can add to a webpage.</p>
<blockquote>
<p>LCP: 600ms slower<br>
2.7MB more JS!<br>
25 more requests<br>
LH score dropped 50%<br>
<strong>--  Matt Hobbs</strong>, <a href="https://twitter.com/TheRealNooshu/status/1350578919389470721">Twitter</a></p>
</blockquote>
<p>Embedding content hosted on a third-party is a great way to keep visitors engaged, without them having to leave the site. However, as with most third-party resources we load, there are costs both in terms of extra network requests, file size, as well as performance penalties.</p>
<p>We're going to look at a few different methods you can apply to Twitter &amp; YouTube embeds. These can help significantly reduce page size and remove/reduce JavaScript that the user has to download and execute, while still delivering content to the user and keeping them on your site.</p>
<h2>Twitter</h2>
<h3>Drop the script tag</h3>
<p>If you want to keep things very simple, just remove the <code>&lt;script&gt;</code> tag that's tacked onto the end of the standard Twitter embed script. It looks like this <code>&lt;script async src=&quot;https://.../widgets.js&quot; charset=&quot;utf-8&quot;&gt;&lt;/script&gt;</code> and you'll find it at the very end of the code Twitter generates for you when you want to embed a tweet.</p>
<pre><code class="language-html">&lt;!-- Twitter embed with script tag --&gt;
&lt;blockquote class=&quot;twitter-tweet&quot; data-dnt=&quot;true&quot; data-theme=&quot;dark&quot;&gt;&lt;p lang=&quot;en&quot; dir=&quot;ltr&quot;&gt;Bernie...go home already &lt;a href=&quot;https://t.co/Ok1WpgjgJS&quot;&gt;pic.twitter.com/Ok1WpgjgJS&lt;/a&gt;&lt;/p&gt;&amp;mdash; The Daily Show (@TheDailyShow) &lt;a href=&quot;https://twitter.com/TheDailyShow/status/1352074243911999489?ref_src=twsrc%5Etfw&quot;&gt;January 21, 2021&lt;/a&gt;&lt;/blockquote&gt; &lt;script async src=&quot;https://platform.twitter.com/widgets.js&quot; charset=&quot;utf-8&quot;&gt;&lt;/script&gt;

&lt;!-- Twitter embed without script tag --&gt;
&lt;blockquote class=&quot;twitter-tweet&quot; data-dnt=&quot;true&quot; data-theme=&quot;dark&quot;&gt;&lt;p lang=&quot;en&quot; dir=&quot;ltr&quot;&gt;Bernie...go home already &lt;a href=&quot;https://t.co/Ok1WpgjgJS&quot;&gt;pic.twitter.com/Ok1WpgjgJS&lt;/a&gt;&lt;/p&gt;&amp;mdash; The Daily Show (@TheDailyShow) &lt;a href=&quot;https://twitter.com/TheDailyShow/status/1352074243911999489?ref_src=twsrc%5Etfw&quot;&gt;January 21, 2021&lt;/a&gt;&lt;/blockquote&gt;
</code></pre>
<p>The scripts above are with &amp; without the <code>&lt;script&gt;</code> tag respectively. I ran a quick test on my local machine &amp; found that comparing the two code snippets above, the one without the <code>&lt;script&gt;</code> tag came in a whopping 2.8MB smaller.</p>
<div class="callout">
<p class="h3 title">Tip</p>
<p>It's worth noting that this method isn't great for tweets with images (the image won't display). I'd very, very strongly recommend using it for tweets that are pure text though.</p>
</div>
<h3>Replace with an image</h3>
<p>Say you do want to embed a tweet that contains an image. In this case, you can use a screenshot of the tweet in place of the code above. You can use a service like <a href="https://tweetcyborg.com/">Tweet Cyborg</a> or a Chrome extension to do the work for you.</p>
<p>With the initial screenshot in hand, I'd recommend running it through image compression and creating WebP and/or AVIF versions of it as well. That way you can be sure you're serving the lightest possible file to users.</p>
<p>As a final step, when publishing the image on your site be sure to add ALT text to the image element to describe it's content for people using screen readers. It's a nice touch to also link to the tweet as well.</p>
<h2>YouTube</h2>
<h3>Lazy-load the iframe</h3>
<p>We've seen that it's possible to lazy-load images, but did you know that the same <code>loading=lazy</code> attribute can also be added to <code>&lt;iframe&gt;</code> tags?</p>
<pre><code class="language-html">&lt;!-- YouTube embed without lazy-loading --&gt;
&lt;iframe width=&quot;560&quot; height=&quot;315&quot; src=&quot;https://www.youtube.com/embed/YM3KszYmn58&quot; frameborder=&quot;0&quot; allow=&quot;accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture&quot; allowfullscreen&gt;&lt;/iframe&gt;

&lt;!-- YouTube embed with lazy-loading --&gt;
&lt;iframe loading=&quot;lazy&quot; width=&quot;560&quot; height=&quot;315&quot; src=&quot;https://www.youtube.com/embed/YM3KszYmn58&quot; frameborder=&quot;0&quot; allow=&quot;accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture&quot; allowfullscreen&gt;&lt;/iframe&gt;
</code></pre>
<p>I <a href="https://www.fershad.com/blog/posts/lazy-loading-embedded-iframes/">wrote about this approach</a> in October last year if you want to get some more details. It's best suited for when you're embedding a YouTube video further down the page - saving about 1.8MB on the initial page load.</p>
<h3>Use an image placeholder</h3>
<p>This <a href="https://css-tricks.com/lazy-load-embedded-youtube-videos/">sick little trick</a> comes courtesy of Arthur Corenzan. It works by replacing the regular (bulky) YouTube embed code with a placeholder image. The YouTube video content only gets loaded if the user clicks on the play button that's programmagically (yep, that's a thing) place on the placeholder. The code looks like this:</p>
<pre><code class="language-html">&lt;iframe
  width=&quot;560&quot;
  height=&quot;315&quot;
  src=&quot;https://www.youtube.com/embed/YM3KszYmn58&quot;
  srcdoc=&quot;&lt;style&gt;*{padding:0;margin:0;overflow:hidden}html,body{height:100%}img,span{position:absolute;width:100%;top:0;bottom:0;margin:auto}span{height:1.5em;text-align:center;font:48px/1.5 sans-serif;color:white;text-shadow:0 0 0.5em black}&lt;/style&gt;&lt;a href=https://www.youtube.com/embed/YM3KszYmn58?autoplay=1&gt;&lt;img src=https://img.youtube.com/vi/YM3KszYmn58/hqdefault.jpg alt='Improving The Page Loading Experience To Reduce Layout Shift by Jen Simmons'&gt;&lt;span&gt;▶&lt;/span&gt;&lt;/a&gt;&quot;
  frameborder=&quot;0&quot;
  allow=&quot;accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture&quot;
  allowfullscreen
  title=&quot;Improving The Page Loading Experience To Reduce Layout Shift by Jen Simmons&quot;
&gt;&lt;/iframe&gt;
</code></pre>
<p>Using this trick I was able to get the YouTube embed size down to 18kB on initial page load. Adding <code>loading=lazy</code> onto this iframe would bring that initial hit down to 0kB if the asset was further down the page.</p>
<div class="callout">
<p class="h3 title">Tip</p>
<p>Be sure to replace the the YouTube video code in the code above - it appears in 3 places. You should also replace the title & alt fields with relevant text.</p>
</div>
<h2>Resources</h2>
<ul>
<li><strong><a href="https://twitter.com/TheRealNooshu/status/1350578919389470721">Matt Hobb's Tweet</a></strong>  - The tweet that inspired this issue.</li>
<li><strong><a href="https://tweetcyborg.com/">Tweet Cyborg</a></strong> - Automatically generate screenshots of any public tweet.</li>
<li><strong><a href="https://www.fershad.com/blog/posts/lazy-loading-embedded-iframes/">Lazy-loading embedded iframes</a></strong> - A short post looking at native browser lazy-loading of iframes, and the benefits it can deliver.</li>
<li><strong><a href="https://css-tricks.com/lazy-load-embedded-youtube-videos/">Lazy load embedded YouTube videos</a></strong> - Arthur Corenzan's technique for creating lightweight YouTube embeds using placeholder images.</li>
</ul>
<h2>Articles</h2>
<p><strong><a href="https://www.smashingmagazine.com/2019/04/cloudflare-workers-serverless/">Going Serverless With Cloudflare Workers</a></strong><br>
I've been learning a heap about Cloudflare Workers recently as part of a small side project I'm building. They're extremely powerful things which allow you to execute code on edge nodes (servers located very close to a user), and even allow you to intercept page requests and apply transformations on the fly. Definitely something I'll be tapping into more this year.</p>
<hr>
<p>The next issue of Optimised will be in your inbox on February (ALREADY!?) 5th. In the meantime, I'd really appreciate it if you could share this email with a friend. As always if you've got any feedback or specific topics you want to be covered then just reply to this email.</p>
<p>Keep safe, stay well.<br>
Fershad.</p>
</main>
  <footer class="footer">
    <div class="wrapper text-center flow">
        <div id="wcb-wrapper"></div>
        <nav>
            <ul>
                
                    <li>
                        <a href="http://localhost:8080">Archive</a>
                    </li>
                
                    <li>
                        <a href="http://localhost:8080/series/">Series</a>
                    </li>
                
                    <li>
                        <a href="http://localhost:8080/contact/">Contact</a>
                    </li>
                
            </ul>
        </nav>
        <div class="text-center">
            <p>Copyright 2022 Fershad Digital
            </p>
            <small>Fershad Digital LTD is a company registered in Taiwan.
                <br>Unified business number: 82954243
                <br>
                <a href="http://localhost:8080/privacy">Privacy policy</a>
            </small>
        </div>
    </div>
</footer>

<!-- <script async src="/js/carbon-badge.mjs" type="module"></script>
<script async nomodule="" src="/js/carbon-badge.js"></script> -->


  <svg class="svg-filters" style="display:none;" version="1.1" xmlns="http://www.w3.org/2000/svg">
    <defs>
      <filter id="marker-shape">
        <feTurbulence basefrequency="0 0.15" numoctaves="1" result="warp" type="fractalNoise" />
        <feDisplacementMap in2="warp" ein="SourceGraphic" scale="30" xchannelselector="R" ychannelselector="G" />
      </filter>
    </defs>
    <rect width="100%" height="100%" filter="url(#marker-shape)" />
  </svg>

  <script async src="/prism/prism.js"></script>
  <link href="/assets/css/tokens.css" rel="stylesheet">

  
</body>

</html>